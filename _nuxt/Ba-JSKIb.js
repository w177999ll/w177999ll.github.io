import a from"./BANbGyBU.js";import{d as s,r as e,j as l,o as t,t as i,x as r,z as n,A as o,F as d,O as m,J as u,I as v,a1 as c,Q as p,v as g,B as f,y as b,K as j,N as y,aN as _}from"./DpD38Hq9.js";import{A as w}from"./Bn1g-ruw.js";import{u as k}from"./DnjT7zNg.js";import{a as C,u as L}from"./CTx_gHj7.js";import{_ as h}from"./hd2usaOF.js";import{u as D}from"./AE7psNvX.js";import{_ as z}from"./gSuRa5u_.js";import{_ as M}from"./MJhzGfyV.js";import{_ as x}from"./Dx5HKwqO.js";import{_ as I}from"./CR7-GpTB.js";import{_ as K,a as R}from"./BaIp519D.js";import{_ as Y}from"./BCo6x5W8.js";import"./BUzHT0Ek.js";import"./Bz3-pLFH.js";import"./DQ0nmumO.js";import"./DjN1tzHg.js";import"./CYSlBwxp.js";import"./CLmcmnGu.js";import"./l2rsThpR.js";import"./DiJwGkuW.js";import"./B4ZxnYc8.js";import"./BOzaSZwJ.js";import"./DLhMPu3G.js";import"./DrZaQ8bd.js";import"./DeVOemtc.js";import"./Cwo8lmsB.js";import"./BjAOOWF7.js";import"./BUIvzWMC.js";import"./Cap6sGiE.js";import"./D3ikBJ7G.js";const A={class:"war-page"},U={class:"page-header"},W={class:"date-section"},q={class:"date-picker-wrapper"},N={class:"date-label"},O={class:"date-actions"},B={class:"war-stats"},F={key:0},J={class:"rank-info"},P={class:"rank-text"},Q={class:"rank-number"},S={class:"summary-grid"},Z={class:"summary-item"},E={class:"item-value win"},G={class:"summary-item"},H={class:"item-value lose"},T={class:"summary-item"},V={class:"item-value building"},X={class:"list-header"},$={class:"members-grid"},aa={class:"member-info"},sa={class:"member-avatar"},ea={class:"member-name"},la={class:"member-stats"},ta={class:"stat-item"},ia={class:"stat-value win"},ra={class:"stat-item"},na={class:"stat-value lose"},oa={class:"stat-item"},da={class:"stat-value building"},ma={class:"stat-item"},ua={class:"stat-value revival"},va=Y(s({__name:"war-detail",setup(s){k({title:"盐场战损情况"});const Y=p(),va=e(!1),ca=e(),pa=e("winCnt"),ga=D(),fa=e(6),ba=C(),ja=L(),ya=l((()=>ja.getLegionWarDetails)),_a=a=>{var s;if(!(null==(s=ya.value)?void 0:s.roleDetailsList))return!1;const e=Math.max(...ya.value.roleDetailsList.map((a=>a.winCnt)));return a.winCnt===e&&a.winCnt>0},wa=l((()=>{var a,s;return null==(s=null==(a=ya.value)?void 0:a.roleDetailsList)?void 0:s.reduce(((a,s)=>a+s.winCnt),0)})),ka=l((()=>{var a,s;return null==(s=null==(a=ya.value)?void 0:a.roleDetailsList)?void 0:s.reduce(((a,s)=>a+s.loseCnt),0)})),Ca=l((()=>{var a,s;return null==(s=null==(a=ya.value)?void 0:a.roleDetailsList)?void 0:s.reduce(((a,s)=>a+s.buildingCnt),0)})),La=l((()=>{var a,s,e;if(!ja.getLegion||!(null==(a=ja.getLegionWarRank)?void 0:a.legionRankList))return ga.error("获取盐场数据失败"),0;const l=null==(s=ja.getLegion)?void 0:s.info.id;let t=null==(e=ja.getLegionWarRank)?void 0:e.legionRankList.findIndex((a=>a.id===l));return t<0?t=0:t+=1,t})),ha=[{label:"按击杀排序",value:"winCnt"},{label:"按复活丹排序",value:"loseCnt"},{label:"按刨地排序",value:"buildingCnt"}],Da=[{label:"普通盐场模式",value:6},{label:"夺旗赛",value:11}],za=l((()=>{var a;return(null==(a=ya.value)?void 0:a.roleDetailsList)?[...ya.value.roleDetailsList].sort(((a,s)=>s[pa.value]-a[pa.value])):[]})),Ma=a=>{if(a>Date.now())return!0;const s=new Date(a).getDay();return 0!==s&&6!==s},xa=a=>{const s=_(ca.value).format("YYYY/MM/DD");ba.send([{cmd:"legion_getwarrank",params:{date:s},respKey:"legion_getwarrankresp"},{cmd:"legionwar_getdetails",params:{date:s},respKey:"legionwar_getdetailsresp"}])};return t((()=>{ba.send({cmd:"legion_getinfo",respKey:"legion_getinforesp"})})),(s,e)=>{const l=a,t=v,p=M,_=h,k=c,C=R,L=K,D=I,ga=x,ba=z;return g(),i("div",A,[r("div",U,[n(t,{quaternary:"",class:"back-btn",onClick:e[0]||(e[0]=a=>d(Y).push("/club"))},{icon:o((()=>[n(l,{name:"ion:arrow-back"})])),default:o((()=>[e[4]||(e[4]=f(" 返回俱乐部 "))])),_:1}),e[5]||(e[5]=r("h1",{class:"page-title"},"盐场战损情况",-1))]),r("div",W,[n(k,null,{default:o((()=>[r("div",q,[r("div",N,[n(l,{name:"ion:calendar",class:"calendar-icon"}),e[7]||(e[7]=r("span",null,"选择盐场日期",-1)),n(p,{type:"warning",size:"small"},{default:o((()=>e[6]||(e[6]=[f("仅限周六/周日")]))),_:1})]),r("div",O,[n(_,{value:ca.value,"onUpdate:value":e[1]||(e[1]=a=>ca.value=a),type:"date","is-date-disabled":Ma,actions:["clear","now"],class:"custom-date-picker","value-format":"yyyy/MM/dd",placeholder:"请选择日期"},null,8,["value"]),n(t,{type:"primary",onClick:xa,disabled:!ca.value,loading:va.value},{icon:o((()=>[n(l,{name:"ion:search"})])),default:o((()=>[e[8]||(e[8]=f(" 查询 "))])),_:1},8,["disabled","loading"])])])])),_:1})]),r("div",B,[va.value||d(ya)?u("",!0):(g(),m(C,{key:0,description:"暂无数据",size:"large"})),n(ba,{show:va.value,description:"加载中..."},{default:o((()=>[d(ya)?(g(),i("div",F,[n(k,{class:"rank-card"},{default:o((()=>[r("div",J,[n(l,{name:"ion:trophy",size:"32",style:{color:"#f0b90b"}}),r("div",P,[e[9]||(e[9]=f(" 本次盐场排名 ")),r("span",Q,"第 "+b(d(La))+" 名",1)])])])),_:1}),n(k,{class:"stats-summary"},{default:o((()=>[r("div",S,[r("div",Z,[e[10]||(e[10]=r("div",{class:"item-label"},"总击杀",-1)),r("div",E,b(d(wa)),1)]),r("div",G,[e[11]||(e[11]=r("div",{class:"item-label"},"总死亡",-1)),r("div",H,b(d(ka)),1)]),r("div",T,[e[12]||(e[12]=r("div",{class:"item-label"},"总刨地",-1)),r("div",V,b(d(Ca)),1)])])])),_:1}),n(k,{class:"members-list"},{header:o((()=>[r("div",X,[e[13]||(e[13]=r("div",{class:"header-title"},"成员战损详情",-1)),n(D,null,{default:o((()=>[n(L,{value:pa.value,"onUpdate:value":e[2]||(e[2]=a=>pa.value=a),options:ha,size:"small",class:"sort-select"},null,8,["value"]),n(L,{value:fa.value,"onUpdate:value":e[3]||(e[3]=a=>fa.value=a),options:Da,size:"small",class:"sort-select"},null,8,["value"])])),_:1})])])),default:o((()=>[r("div",$,[(g(!0),i(j,null,y(d(za),(a=>(g(),m(k,{key:a.roleId,class:"member-card",size:"small"},{default:o((()=>[r("div",aa,[r("div",sa,[n(ga,{src:a.headImg,"fallback-src":d(w).defaultAvatar,size:"large",circle:""},null,8,["src","fallback-src"]),r("div",ea,b(a.name),1),_a(a)?(g(),m(l,{key:0,name:"ion:diamond",style:{color:"orange"}})):u("",!0)]),r("div",la,[r("div",ta,[e[14]||(e[14]=r("div",{class:"stat-label"},"击杀",-1)),r("div",ia,b(a.winCnt),1)]),r("div",ra,[e[15]||(e[15]=r("div",{class:"stat-label"},"死亡",-1)),r("div",na,b(a.loseCnt),1)]),r("div",oa,[e[16]||(e[16]=r("div",{class:"stat-label"},"刨地",-1)),r("div",da,b(a.buildingCnt),1)]),r("div",ma,[e[17]||(e[17]=r("div",{class:"stat-label"},"复活丹",-1)),r("div",ua,b(a.loseCnt-6>0?a.loseCnt-6:0),1)])])])])),_:2},1024)))),128))])])),_:1})])):u("",!0)])),_:1},8,["show"])])])}}}),[["__scopeId","data-v-c84ea1c4"]]);export{va as default};